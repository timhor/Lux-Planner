<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWhdBjPKjj_DNstBfp3i65VTtCeEzucyc&libraries=places"></script>
  
<br>
<div id="body_div">
  <div id="journeyHead">
    <h2>New Journey</h2>
  </div>

  <form [formGroup]="myJourneys" (ngSubmit)="submit()">
    <hr>
    <div class="row">
      <div class="col-sm-5">
        <label id="stop-label">Starting Location</label>
        <input type="search" placeholder="Location" autocorrect="off" autocapitalize="off" spellcheck="off" class="form-control" #search>
        
      </div>
      <div class="col-sm-2">
        <br>
        <a target="_blank" routerLink="/stop"><i class="glyphicon glyphicon-info-sign grow" aria-hidden="true" id="infoIcon"></i></a>            
      </div>
      <div class="col-sm-4">
        <label id="date-label">Departure Date</label>
        <input type="date" placeholder="Date" class="form-control">
      </div>
    </div>
    <hr>
    <fieldset formArrayName="destinations">
      <div class="form-group row"
            *ngFor="let item of myJourneys.get('destinations').controls; let i=index"
            [formGroup]="item">
        <div class="col-sm-5">
          <label id="stop-label" [attr.for]="'location'+i">Next Location</label>
          <input type="search" placeholder="Location" autocorrect="off" autocapitalize="off" spellcheck="off" class="form-control" #search          
            [attr.id]="'location'+i" formControlName="location">
        </div>
        <div class="col-sm-2">
          <br>
          <a target="_blank" routerLink="/stop"><i class="glyphicon glyphicon-info-sign grow" aria-hidden="true" id="infoIcon"></i></a>            
        </div>
        <div class="col-sm-4">
          <label id="date-label" [attr.for]="'date'+i">Departure Date</label>
          <input type="date" placeholder="Date" class="form-control"
            [attr.id]="'date'+i" formControlName="date">
        </div>
        <div class="col-sm-1">
          <br>
          <button type="button" id="btnFormat" class="btn btn-danger" *ngIf="myJourneys.get('destinations').length != 1"
                  (click)="myJourneys.get('destinations').removeAt(i)"><i class="fa fa-trash" aria-hidden="true"></i></button>
        </div>
      </div>
      <br>
    </fieldset>
    <div class="form-group row">
      <div class="col-sm-1">
        <button type="button" id="btnFormat" class="btn btn-primary"
                (click)="myJourneys.get('destinations').push(buildItem(''))"><i class="fa fa-plus-circle" aria-hidden="true"></i>&nbsp;Add Stop</button>
      </div>
    </div>
    <hr>
    <br>
    <div class="row">
      <div class="form-group col-sm-6">
          <h1><button type="submit" class="button_primary"
            value="Submit" [disabled]="myJourneys?.invalid" routerLink="/itinerary">Customise Itinerary&nbsp;&nbsp;<i class="fa fa-caret-right"></i></button></h1>
      </div>
      <div class="form-group col-sm-6">
        <h1><button type="submit" class="button_primary" id="saveJourneyBtn"
          value="Submit" routerLink="/my-journeys">Save Journey&nbsp;&nbsp;<i class="fa fa-caret-right"></i></button></h1>
      </div>
    </div>
  </form>
  <!-- <h6 class="mt-3">FormGroup Model (<code>myJourneys.value</code>)</h6>
  <div><pre><code>{{ myJourneys?.value | json }}</code></pre></div> -->
  
</div>
<br><br>